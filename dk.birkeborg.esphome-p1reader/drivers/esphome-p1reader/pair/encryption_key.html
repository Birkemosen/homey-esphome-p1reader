<!-- Views are rendered by Homey using Handlebars -->
<style type="text/css">
  .form-group {
    margin-bottom: 1rem;
  }

  .form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: bold;
  }

  .form-control {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 4px;
  }

  .info-container {
    padding: 20px;
  }

  .note {
    margin-top: 20px;
    padding: 15px;
    background-color: #f8f9fa;
    border-left: 4px solid #0076ff;
  }

  .error-message {
    color: #dc3545;
    margin-top: 0.5rem;
    display: none;
  }
</style>

<div class="info-container">
  <h2 data-i18n="pair.encryption_key.title">Enter Encryption Key</h2>

  <div class="form-group">
    <label for="encryption_key" class="form-label" data-i18n="pair.encryption_key.label">Encryption Key</label>
    <input type="text" class="form-control" id="encryption_key" value="" />
    <div id="error-message" class="error-message"></div>
  </div>

  <div class="note">
    <p data-i18n="pair.encryption_key.note">Please enter the encryption key for your ESPHome device. This key is required for secure communication.</p>
  </div>
</div>

<script type="text/javascript">
  const keyInput = document.getElementById('encryption_key');
  const errorMessage = document.getElementById('error-message');

  // Handle key input
  keyInput.addEventListener('input', function (e) {
    const currentKey = e.target.value.trim();
    // Store the current key value using an event
    Homey.emit('encryption_key_entered', currentKey);
    errorMessage.style.display = 'none';
  });
</script>